<!doctype html>
<html lang="en">
  <head>
    <title>Оперативный план</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    {% load static %}
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/static/css/bootstrap.min.css" >
    <!-- Bootstrap JS + Popper JS -->
    <script defer src="/static/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="{% static 'css/styles_mh.css' %}" />
    <link rel="shortcut icon" href="/static/image/site_logo.png" />
    

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var form = document.querySelector('form');
        var loadingIndicator = document.getElementById('loadingIndicator');
        var submitButton = document.getElementById('startButton');

        form.addEventListener('submit', function() {
          loadingIndicator.style.display = 'block';
          submitButton.disabled = true;
          submitButton.value = 'Ожидайте';
        });
      });
    </script>

  </head>

  <body style="margin: 0; overflow: scroll">
    <header class="header">
      <a href="/homepage/">
        <img class="header__logo" src="/static/image/polyus_logo.png">
      </a>
    </header>
    

    <h1 class="page_header">Оперативный план</h1>

    <!-- Индикатор загрузки -->
    <div id="loadingIndicator">
      <div class="spinner"></div>
    </div>


    <form method="POST" style="margin-left: 10px; margin-top: 40px; width: 500px" action="{% url 'op' %}" enctype="multipart/form-data">
      {% csrf_token %}
      
      <div class="mb-3">
        <label for="branch" class="form-label">Филиал:</label>
        <select name ="select_branch" class="form-select" id="branch">
          <option value="IRK">IRK</option>
          <option value="KRS">KRS</option>
          <option value="MGD">MGD</option>
          <option value="YAK">YAK</option>
        </select>
      </div>

      <div class="mb-3">
        <div class="row">

          <div class="col">
            <label for="month" class="form-label">Месяц:</label>
            <select name ="select_month" class="form-select" id="month">
              <option value="Январь">Январь</option>
              <option value="Февраль">Февраль</option>
              <option value="Март">Март</option>
              <option value="Апрель">Апрель</option>
              <option value="Май">Май</option>
              <option value="Июнь">Июнь</option>
              <option value="Июль">Июль</option>
              <option value="Август">Август</option>
              <option value="Сентябрь">Сентябрь</option>
              <option value="Октябрь">Октябрь</option>
              <option value="Ноябрь">Ноябрь</option>
              <option value="Декабрь">Декабрь</option>
            </select>
          </div>

          <div class="col">
            <label for="year" class="form-label">Год:</label>
            <select name ="select_year" class="form-select" id="year">
              <option value="2024">2024</option>
              <option value="2025">2025</option>
              <option value="2026">2026</option>
              <option value="2027">2027</option>
              <option value="2028">2028</option>
            </select>
          </div>

        </div>
      </div>

      <div class="mb-3">
        <label for="formPlanFile" class="form-label">
          Объемный план:
          <a href="" class="custom-tooltip">
            <img  class="question_logo" src="/static/image/question.svg">
            <span class="tooltip-text">Файл с потребностью от заказчиков</span>
          </a>
        </label>
        <input name ="plan_file" class="form-control" type="file" accept=".xl*"  id="formPlanFile" required>
      </div>

      <div class="mb-3">
        <label for="formDirectoryFile" class="form-label">
          Справочник:
          <a href="" class="custom-tooltip">
            <img  class="question_logo" src="/static/image/question.svg">
            <span class="tooltip-text">Файл со списком доступных ресурсов</span>
          </a>
        </label>
        <input name ="dir_file" class="form-control" type="file" accept=".xl*"  id="formDirectoryFile" required>
      </div>

      <input id="startButton" type="submit" class="btn btn-warning upload" value="Загрузить" style="margin-top: 15px; width: 500px;">
      
      {% if display_success %}
      <button type="button" class="btn btn-warning upload" style="margin-top: 15px; width: 500px;">Скачать</button>
      {% endif %}

    </form>
  

    {% if display_error %}
    <div class="alert alert-danger" role="alert" id="alert_message" style="margin-top: 20px; width: auto; margin-left: 10px; margin-right: 10px; bottom: 0;">
      {{ display_text|safe }}
    </div>

    <script>
      setTimeout(function(){
        document.getElementById('alert_message').style.display = 'none';
      }, 3000);
      </script>
    {% endif %}


    {% if display_success %}
    <div class="alert alert-success" role="alert" id="success_message" style="margin-top: 20px; width: auto; margin-left: 10px; margin-right: 10px; bottom: 0;">
      {{ display_text }}
    </div>

    <script>
      setTimeout(function(){
        document.getElementById('success_message').style.display = 'none';
      }, 3000);
      </script>
    {% endif %}

  </body>

</html>
